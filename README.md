doesnt handle duplicates and the locations on the ACK are not swapped
